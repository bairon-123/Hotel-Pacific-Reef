<ion-header class="site-header">
  <ion-toolbar color="light">
    <div class="container navbar">
      <div class="brand">
        <ion-icon name="stats-chart-outline"></ion-icon>
        <span>Admin ‚Ä¢ Reportes</span>
      </div>

      <nav class="menu">
        <a routerLink="/admin">Dashboard</a>
        <a routerLink="/admin/usuarios">Usuarios</a>
        <a routerLink="/admin/reservas">Reservas</a>
        <a routerLink="/admin/habitaciones">Habitaciones</a>
        <a routerLink="/admin/reportes" routerLinkActive="active">Reportes</a>
        <a href="#" class="logout" (click)="logout($event)">Cerrar sesi√≥n</a>
      </nav>
    </div>
  </ion-toolbar>
</ion-header>

<ion-content class="site-content ion-padding">
  <ion-card>
    <ion-card-header>
      <ion-card-title>Totales por mes</ion-card-title>
      <ion-card-subtitle>Ingresos y cantidad de reservas (CLP)</ion-card-subtitle>
    </ion-card-header>
    <ion-card-content>
      <ion-list>
        <ion-item *ngFor="let r of totalesMes">
          <ion-label>
            <div class="row1"><b>{{ r.mes }}</b></div>
            <div class="row2">
              <span>üßæ Reservas: {{ r.reservas }}</span>
            </div>
          </ion-label>
          <ion-badge color="primary">{{ currency(r.total) }}</ion-badge>
        </ion-item>

        <ion-item lines="full">
          <ion-label>
            <b>Total general</b>
            <small class="muted">({{ totalReservasGeneral() }} reservas)</small>
          </ion-label>
          <ion-badge color="success"><b>{{ currency(totalGeneral()) }}</b></ion-badge>
        </ion-item>
      </ion-list>

      <ion-button class="export" size="small" fill="outline" (click)="exportCSV()">
        <ion-icon name="download-outline" slot="start"></ion-icon>
        Exportar CSV
      </ion-button>
    </ion-card-content>
  </ion-card>

  <ion-card>
    <ion-card-header>
      <ion-card-title>Detalle de reservas</ion-card-title>
      <ion-card-subtitle>Cliente, habitaci√≥n, fechas y montos</ion-card-subtitle>
    </ion-card-header>
    <ion-card-content>
      <ion-list>
        <ion-item *ngFor="let d of detalle">
          <ion-label>
            <div class="row1">
              <b>{{ d.nombrePersona || d.email }}</b>
              <span class="muted">({{ d.email }})</span>
            </div>
            <div class="row2">
              <span>üè® {{ d.nombreHabitacion }} ({{ d.tipo | titlecase }})</span>
              <span>üóì {{ d.llegada }} ‚Üí {{ d.salida }} ({{ effectiveNights(d) }} noche/s)</span>
              <span>üíµ {{ currency(d.precioNoche) }}/noche ‚Ä¢
                <b>{{ currency(totalOf(d)) }}</b>
              </span>
            </div>
            <small class="created">Creada: {{ d.createdAt | date:'short' }}</small>
          </ion-label>
        </ion-item>

        <ion-item *ngIf="!detalle.length" lines="none">
          <ion-label color="medium">A√∫n no hay reservas.</ion-label>
        </ion-item>
      </ion-list>

      <ion-button size="small" fill="outline" (click)="exportDetalleExcel()">
        <ion-icon name="download-outline" slot="start"></ion-icon>
        Exportar detalle (Excel)
      </ion-button>
    </ion-card-content>
  </ion-card>
</ion-content>
